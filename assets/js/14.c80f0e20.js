(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{402:function(t,e,a){"use strict";a.r(e);var n=a(54),s=Object(n.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"webpack设置不打包某些文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#webpack设置不打包某些文件"}},[t._v("#")]),t._v(" webpack设置不打包某些文件")]),t._v(" "),a("blockquote",[a("p",[t._v("最近遇到了这种需求，要实现webpack打包后，一个全局配置文件"),a("code",[t._v("config.js")]),t._v("不被打包。最终目的是我们可以在打包后的文件中修改这个文件（比如配置全局请求url前缀等等）。")]),t._v(" "),a("p",[a("strong",[t._v("要实现这个功能我们需要三步操作。")])]),t._v(" "),a("ol",[a("li",[t._v("了解webpack的整个大致打包流程")]),t._v(" "),a("li",[t._v("通过修改webpack配置文件，将某个文件拷贝到输出资源目录(而不是通过打包输出)")]),t._v(" "),a("li",[t._v("在模板index.html中引入")])])]),t._v(" "),a("h2",{attrs:{id:"webpack大致打包流程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#webpack大致打包流程"}},[t._v("#")]),t._v(" webpack大致打包流程")]),t._v(" "),a("p",[t._v("通过查看网上的资料，可以了解到下面的打包流程:")]),t._v(" "),a("p",[a("strong",[t._v("1. 初始化参数：从配置文件和 Shell 语句中读取与合并参数，得出最终的参数")]),t._v("；")]),t._v(" "),a("p",[a("strong",[t._v("2. 开始编译：用上一步得到的参数初始化 Compiler 对象，加载所有配置的插件，执行对象的 run 方法开始执行编译")]),t._v("；")]),t._v(" "),a("p",[a("strong",[t._v("3. 确定入口：根据配置中的 entry 找出所有的入口文件")]),t._v("；")]),t._v(" "),a("p",[a("strong",[t._v("4. 编译模块：从入口文件出发，调用所有配置的 Loader 对模块进行翻译，再找出该模块依赖的模块，再递归本步骤直到所有入口依赖的文件都经过了本步骤的处理")]),t._v("；")]),t._v(" "),a("p",[a("strong",[t._v("5. 完成模块编译：在经过第4步使用 Loader 翻译完所有模块后，得到了每个模块被翻译后的最终内容以及它们之间的依赖关系")]),t._v("；")]),t._v(" "),a("p",[a("strong",[t._v("6. 输出资源：根据入口和模块之间的依赖关系，组装成一个个包含多个模块的 Chunk，再把每个 Chunk 转换成一个单独的文件加入到输出列表，这步是可以修改输出内容的最后机会")]),t._v("；")]),t._v(" "),a("p",[a("strong",[t._v("7. 输出完成：在确定好输出内容后，根据配置确定输出的路径和文件名，把文件内容写入到文件系统")]),t._v("。")]),t._v(" "),a("p",[t._v("注： 参考自https://juejin.im/post/5d70b186f265da03e1689864")]),t._v(" "),a("p",[t._v("通过第"),a("strong",[t._v("4")]),t._v("步我们可以得知，我们不能在任何会经过打包的文件中引入我们的"),a("code",[t._v("config.js")]),t._v("。因为"),a("code",[t._v("webpack")]),t._v("会从入口文件开始递归所有引入的模块进行打包。")]),t._v(" "),a("h2",{attrs:{id:"复制不打包文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#复制不打包文件"}},[t._v("#")]),t._v(" 复制不打包文件")]),t._v(" "),a("p",[t._v("我们需要借助一个"),a("code",[t._v("webpack")]),t._v("插件"),a("code",[t._v("copy-webpack-plugin")]),t._v("来进行拷贝我们的文件。")]),t._v(" "),a("p",[t._v("官网: https://www.npmjs.com/package/copy-webpack-plugin")]),t._v(" "),a("ul",[a("li",[t._v("安装依赖")])]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("npm i copy-webpack-plugin\n")])])]),a("ul",[a("li",[t._v("引入")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// webpack.config.js")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" CopyPlugin "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'copy-webpack-plugin'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n \nmodule"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  plugins"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("CopyPlugin")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" from"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'source'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" to"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'dest'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" from"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'other'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" to"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'public'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("ul",[a("li",[t._v("详细配置")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"center"}},[t._v("Name")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("Type")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("Default")]),t._v(" "),a("th",{staticStyle:{"text-align":"left"}},[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"center"}},[a("a",{attrs:{href:"https://www.npmjs.com/package/copy-webpack-plugin#from",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("from")]),a("OutboundLink")],1)]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[a("code",[t._v("{String\\|Object}")])]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[a("code",[t._v("undefined")])]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("Glob or path from where we сopy files.")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[a("a",{attrs:{href:"https://www.npmjs.com/package/copy-webpack-plugin#to",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("to")]),a("OutboundLink")],1)]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[a("code",[t._v("{String}")])]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[a("code",[t._v("compiler.options.output")])]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("Output path.")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[a("a",{attrs:{href:"https://www.npmjs.com/package/copy-webpack-plugin#context",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("context")]),a("OutboundLink")],1)]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[a("code",[t._v("{String}")])]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[a("code",[t._v("options.context \\|\\| compiler.options.context")])]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("A path that determines how to interpret the "),a("code",[t._v("from")]),t._v(" path.")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[a("a",{attrs:{href:"https://www.npmjs.com/package/copy-webpack-plugin#totype",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("toType")]),a("OutboundLink")],1)]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[a("code",[t._v("{String}")])]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[a("code",[t._v("undefined")])]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("Determinate what is "),a("code",[t._v("to")]),t._v(" option - directory, file or template.")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[a("a",{attrs:{href:"https://www.npmjs.com/package/copy-webpack-plugin#test",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("test")]),a("OutboundLink")],1)]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[a("code",[t._v("{String\\|RegExp}")])]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[a("code",[t._v("undefined")])]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("Pattern for extracting elements to be used in "),a("code",[t._v("to")]),t._v(" templates.")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[a("a",{attrs:{href:"https://www.npmjs.com/package/copy-webpack-plugin#force",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("force")]),a("OutboundLink")],1)]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[a("code",[t._v("{Boolean}")])]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[a("code",[t._v("false")])]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("Overwrites files already in "),a("code",[t._v("compilation.assets")]),t._v(" (usually added by other plugins/loaders).")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[a("a",{attrs:{href:"https://www.npmjs.com/package/copy-webpack-plugin#ignore",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("ignore")]),a("OutboundLink")],1)]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[a("code",[t._v("{Array}")])]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[a("code",[t._v("[]")])]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("Globs to ignore files.")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[a("a",{attrs:{href:"https://www.npmjs.com/package/copy-webpack-plugin#flatten",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("flatten")]),a("OutboundLink")],1)]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[a("code",[t._v("{Boolean}")])]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[a("code",[t._v("false")])]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("Removes all directory references and only copies file names.")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[a("a",{attrs:{href:"https://www.npmjs.com/package/copy-webpack-plugin#cache",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("cache")]),a("OutboundLink")],1)]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[a("code",[t._v("{Boolean\\|Object}")])]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[a("code",[t._v("false")])]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("Enable "),a("code",[t._v("transform")]),t._v(" caching. You can use "),a("code",[t._v("{ cache: { key: 'my-cache-key' } }")]),t._v(" to invalidate the cache.")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[a("a",{attrs:{href:"https://www.npmjs.com/package/copy-webpack-plugin#transform",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("transform")]),a("OutboundLink")],1)]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[a("code",[t._v("{Function}")])]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[a("code",[t._v("undefined")])]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("Allows to modify the file contents.")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[a("a",{attrs:{href:"https://www.npmjs.com/package/copy-webpack-plugin#transformpath",target:"_blank",rel:"noopener noreferrer"}},[a("code",[t._v("transformPath")]),a("OutboundLink")],1)]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[a("code",[t._v("{Function}")])]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[a("code",[t._v("undefined")])]),t._v(" "),a("td",{staticStyle:{"text-align":"left"}},[t._v("Allows to modify the writing path.")])])])]),t._v(" "),a("h2",{attrs:{id:"在模板index-html中引入"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在模板index-html中引入"}},[t._v("#")]),t._v(" 在模板index.html中引入")]),t._v(" "),a("p",[t._v("在html中引入不打包的配置文件，一般不打包文件都放在根目录下的"),a("code",[t._v("static")]),t._v("文件夹中，打包后放在"),a("code",[t._v("dist")]),t._v("文件夹。"),a("strong",[t._v("在html文件中使用script标签引用")]),t._v("即可。注意这时候在其他组件文件中需要访问的话，可以在"),a("code",[t._v("config.js")]),t._v("中定义全局变量，这时候在其他文件中可以直接通过"),a("code",[t._v("window.*")]),t._v("进行访问。")]),t._v(" "),a("p",[t._v("本例中的"),a("code",[t._v("config.js")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("URL_CONFIG")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"url"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"测试url"')]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"url"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"测试url"')]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"url"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"测试url"')]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("本例中的"),a("code",[t._v("public/index.html")])]),t._v(" "),a("div",{staticClass:"language-html extra-class"},[a("pre",{pre:!0,attrs:{class:"language-html"}},[a("code",[t._v("...\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("id")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("root"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("src")]),a("span",{pre:!0,attrs:{class:"token attr-value"}},[a("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("./static/config.js"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),a("span",{pre:!0,attrs:{class:"token script"}}),a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token tag"}},[a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n...\n")])])]),a("p",[t._v("在组件中访问"),a("code",[t._v("src/pages/index/index.jsx")])]),t._v(" "),a("div",{staticClass:"language-js extra-class"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[t._v("console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("window"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("URL_CONFIG")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("p",[t._v("Bingo!")]),t._v(" "),a("h2",{attrs:{id:"参考资料"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考资料"}},[t._v("#")]),t._v(" 参考资料")]),t._v(" "),a("p",[t._v("https://blog.csdn.net/momDIY/article/details/87906111")]),t._v(" "),a("p",[t._v("https://juejin.im/post/5d70b186f265da03e1689864")])])}),[],!1,null,null,null);e.default=s.exports}}]);